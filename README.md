# Архітектура програмного забезпечення

## Розрахункова-графічна робота

### **Тема**: Архітектурні діаграми та бенчмарки

### **Мета**: Закріплення навичок ілюстрації організації програмних систем та оцінки часу виконання алгоритмів

---

### Виконали студенти групи ІП-93:
- Рожицький Максим
- Стронов Іван
- Шаповал Лев

---

### Зміст

- [Усі завдання](#Завдання)
- [Завдання-1](#Завдання-1)
- [Завдання-2](#Завдання-2)
- [Завдання-3](#Завдання-3)

### Завдання

- Для 2-ої роботи, підтвердьте лінійний час виконання вашої функції перетворення чи обчислення вхідного виразу

- Для 3-ої роботи, побудуйте діаграму взаємодії компонентів у вашій імплементації

- Для 4-ої роботи, побудуйте діаграму взаємодії для вашої реалізації (на ній, скоріш за все, мають опинитися компоненти парсера, черги команд, ядра цикла) та підтвердьте лінійний час роботи вашого парсера команд

---

### Завдання-1

За нашим варіантом нам необхідно було обчислити префіксний вираз. Аби підтвердити лінійний час виконання нашої функції, ми будемо використовувати бенчмарк тест, запускаючи функцію з різним розміром даних, збільшуючи постійно розмір даних.

Наведений код нижче запускає функції **CalculatePrefix** 20 разів, при цьому передаючи вхідний рядок різного розміру. Бенчмарк надає можливість отримати середній час виконання функції для кожного розміру.

У глобальні змінних пакет, а також err зберігається результат виконання функції і помилка відповідно. Це необхідно для уникнення оптимізації.

```go
package lab2

import (
	"fmt"
	"testing"
)

var initialValue string = "+ 2 2"
var cntRes int
var err error

func BenchmarkCount(b *testing.B) {
	const baseLen = 3000

	for i := 0; i < 20; i++ {
		inputValue := initialValue
		iterations := baseLen * (i + 1)

		for j := 0; j < iterations; j++ {
			inputValue = "+ " + inputValue + " "
			inputValue = inputValue + initialValue
		}

		b.Run(fmt.Sprintf("len=%d", iterations), func(b *testing.B) {
			cntRes, err = CalculatePrefix(inputValue)
		})
	}
}
```

---

Результати запуску бенчмарка:

Можемо побачити, що на першій ітерації виконання тесту відбувається настільки швидко, що не відображається час виконання.

![image](https://user-images.githubusercontent.com/55399296/147410723-ca51529a-d3a4-405f-a731-7165ff51f119.png)

---

Графік, побудований на основі отриманих значень:

![image](https://user-images.githubusercontent.com/55399296/147410853-b4ea7fb5-8138-47e6-938e-9a20c576749e.png)

З графіку видно, що час виконання нашої функції лінійно збільшується. Також можемо побачити, що значення x іноді менше за значення х-1, це можна пояснити тим, що тестування відбувалось не в ідеальних умовах.

---

### Завдання-2

<p align="center">
  <img src="https://user-images.githubusercontent.com/56270570/147507616-e2d62b62-95d9-47c2-8c59-a18299f9807f.png" />
</p>

Пояснення:

1. Юзер йде у початку схеми. Оскільки він може обрати як запит Get, так і Post, було вирішено розділити діаграму на два шляхи.
2. Далі у клієнта викликається одна і там сама функція, але з різними параметрами, що залежать від вибору користувача.
3. Після цього викликається або функція демонстрації усієї інформації, або передається необхідна інформація із потрібним апдейтом.
4. І в кінці відбувається під'єднання до бази даних, де, в залежності від вибору користувача, ми або отримуємо інформацію про всі машини, 
або оновлюємо статус обраної машини.

---

### Завдання-3

Діаграма взаємодії:

![image](https://user-images.githubusercontent.com/55399296/147479693-605df8c7-20af-43c6-8493-5843d0256663.png)

---

Код bench_test.go файлу:

```go
package main

import (
	"fmt"
	"testing"
	"strings"

	"github.com/BusyPeopleAPZ/architecture-lab-4/engine"
)

var command = "print"
var cntRes engine.Command

func BenchmarkCount(b *testing.B) {
	baseLen := 200000
	for i := 0; i < 13; i++ {
		baseLen = 2 * baseLen
		inputValue := command
		inputValue += strings.Repeat("BBB", baseLen)

		b.Run(fmt.Sprintf("len=%d", baseLen), func(b *testing.B) {
			cntRes = parse(inputValue)
		})
	}
}
```

---

Результати запуску бенчмарка:

![image](https://user-images.githubusercontent.com/55399296/147481149-5acbd0d9-e948-417f-ad05-bba7c0612d02.png)

---

Графік, побудований на основі отриманих значень:

![image](https://user-images.githubusercontent.com/55399296/147481001-4b6cb5cc-8ac9-414a-8b58-94666b5e6304.png)

З графіку видно, що час виконання нашої функції лінійно збільшується, що й необхідно було підтвердити.
